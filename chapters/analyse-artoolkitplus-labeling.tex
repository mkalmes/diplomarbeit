\subsubsection{Regionenmarkierung} % (fold)
\label{sub:regionenmarkierung}

Die Methode \textproc{arLabeling} (\autoref{alg:arlabeling-init1}--\autoref{alg:arlabeling-calcregiondata}) wird zur
 Markierung der Regionen in einem Bildsignal $I$ verwendet. Wie in \autoref{sub:fiducial_detection} beschrieben,
 verzichet ARToolKitPlus beim Aufruf des Verfahrens auf ein Binärbild. Stattdessen wird ein Bildsignal $I$ während der
 Verarbeitung durch eine Schwellwertanalyse untersucht. \textproc{arLabeling} kann in drei Abschnitte unterteilt werden
 (Vgl. \autoref{alg:arlabeling-overview}):
\begin{enumerate}
	\item Initialisierung der Variablen und des Speichers, \label{label-init}
	\item Regionenmarkierung und Auflösen von Kollisionen und \label{label-region}
	\item Aufbereiten der Regionenmarkierung zur Speicherung. \label{label-cleaning}
\end{enumerate}
\input{alg/analyse-artplus/arlabeling-overview}

\autoref{label-init} ist in \autoref{alg:arlabeling-init1} aufgeführt.
\input{alg/analyse-artplus/arlabeling-init1}
In Zeile \ref{alg:arlabeling-init1-local-start}--\ref{alg:arlabeling-init1-local-end} werden die lokalen Variablen
 deklariert, deren Bedeutung bei ihrem ersten Auftreten erklärt werden. Speicheradressen werden in Zeile
 \ref{alg:arlabeling-init1-address-start}--\ref{alg:arlabeling-init1-address-end} initialisiert. Der
 Schwellwertparameter wird verdreifacht und lokal gespeichert (Zeile \ref{alg:arlabeling-init1-threshold}). Die
 Schwellwertanalyse in \autoref{alg:arlabeling-regionlabeling} benutzt einen dreifachen Wert als Optimierung
 (Vgl. S.~\pageref{sub:arlabel-threshold}). Zum Schluss wird in Zeile
 \ref{alg:arlabeling-init1-size-start}--\ref{alg:arlabeling-init1-size-end} die Bildbreite durch die Konstante
 $\mathit{arImXsize}$ und die Bildhöhe durch die Konstante $\mathit{arImYsize}$ festgelegt. Das halbieren der Bildhöhe
 und -breite ist eine Optimierung (Vgl. \autoref{sec:vorgehen}). Das initialisieren der Variablen erfolgt in konstanter
 Laufzeit $T(n) = 39$.

Die Initialisierung von \textproc{arLabeling} wird in \autoref{alg:arlabeling-init2} fortgesetzt.
\input{alg/analyse-artplus/arlabeling-init2}
$\mathit{pnt1}$ wird in Zeile \ref{alg:arlabeling-init2-address1-start} auf die erste Speicherstelle der ersten Zeile
 des Regionenbildes gesetzt. $\mathit{pnt2}$ erhält in Zeile \ref{alg:arlabeling-init2-address1-end} die erste
 Speicherstelle der letzten Zeile des Regionenbildes.
% In der Schleife in Zeile \ref{alg:arlabeling-init2-loop1-start}--\ref{alg:arlabeling-init2-loop1-end} wird
%  über die Breite des Regionenbildes iteriert, um die erste und die letzte Zeile des Regionenbildes zu löschen.
In der Schleife in Zeile \ref{alg:arlabeling-init2-loop1-start}--\ref{alg:arlabeling-init2-loop1-end} wird die erste
 und die letzte Zeile des Regionenbildes gelöscht. Dazu wird an den Adressen von
 $\mathit{pnt1}$ und $\mathit{pnt2}$ der Wert $0$ gespeichert. Danach werden die Adressen von $\mathit{pnt1}$ und
 $\mathit{pnt2}$ inkrementiert. In Zeile \ref{alg:arlabeling-init2-inc-1} wird die Laufvariable $i$ inkrementiert. In
 Zeile \ref{alg:arlabeling-init2-address2-start}--\ref{alg:arlabeling-init2-address2-end} werden die Adressen
 von $\mathit{pnt1}$ und $\mathit{pnt2}$ erneut festgelegt. $\mathit{pnt1}$ wird die erste Speicherstelle des
 Regionenbildes zugewiesen. In $\mathit{pnt2}$ wird die Adresse der ersten Speicherstelle der letzten Zeile hinterlegt.
 In der Schleife von Zeile \ref{alg:arlabeling-init2-loop2-start}--\ref{alg:arlabeling-init2-loop2-end} wird die erste
 und letzte Spalte des Regionenbildes gelöscht, indem der Wert $0$ an die Speicherstelle von $\mathit{pnt1}$ und
 $\mathit{pnt2}$ geschrieben wird
 (Zeile \ref{alg:arlabeling-init2-clearfirstrow}--\ref{alg:arlabeling-init2-clearlastrow}). Im Anschluss daran werden
 die Adressen $\mathit{pnt1}$ und $\mathit{pnt2}$ auf die nächste Position der Bildspalte inkrementiert, indem die
 Breite $\mathit{lxsize}$ auf die Adressen addiert wird. Danach wird $i$ inkrementiert. In Zeile
 \ref{alg:arlabeling-init2-label} wird die Markierungsvariable $\mathit{wk\_max}$ mit dem Wert $0$ initialisiert.
 Danach wird die Adresse der Startposition des Regionenbildes in $\mathit{pnt2}$ gespeichert. Dabei ist zu beachten,
 dass die Adresse auf den zweiten \gls{pixel} der zweiten Zeile verweist. $\mathit{pnt}$ wird daraufhin die Adresse des
 Bildsignals $I$ zugewiesen. Der Adresse von $I$ ist der vierte \gls{pixel} der zweiten Zeile. Die Variable
 $\mathit{poff}$ ist der Adressabstand der \gls{pixel} in $I$ und dient der Adressierung des nächsten \glspl{pixel}.
 $\mathit{poff}$ wird in der letzten Zeile von \autoref{alg:arlabeling-init2} gesetzt. Die Kosten des Algorithmus sind
 in \autoref{alg:arlabeling-init2} angegeben. Durch Umformung der Kosten von \autoref{eq:analyse-arlabeling-init-1}
 erhalten wir die Laufzeitfunktion \autoref{eq:analyse-arlabeling-init-2}.
\input{eq/artplus/arlabeling-init}
Das asymptotische Wachstum für $T(\mathit{lxsize}) = 6\mathit{lxsize} + 1$ ist, für die Werte $c_{1} = 6$,
 $c_{2} = 7$ und $\mathit{lxsize}_{0} = 1$, $6\mathit{lxsize} + 1 = \Theta(lxsize)$. Für
 $T(\mathit{lysize}) = 8\mathit{lysize} + 9$, mit den Werten $c_{1} = 7$, $c_{2} = 9$ und $\mathit{lysize}_{0} = 9$,
 ist das Wachstum $8\mathit{lysize} + 9 = \Theta(lysize)$.

\autoref{label-region} von \autoref{alg:arlabeling-overview} ist für die Regionenmarkierung und das Auflösen von
 Kollisionen verantwortlich. Eine Übersich des Verfahrens ist in \autoref{alg:arlabeling-regionlabeling} dargestellt.
\input{alg/analyse-artplus/arlabeling-regionlabeling}
 \textproc{arLabeling} untersucht das Bildsignal $I$ zeilenweise von links oben nach rechts unten. Durch eine
 Schwellwertanalyse wird entschieden, ob ein \gls{pixel} an Position $I(u,v)$ ein Vordergrund- oder Hintergrundpixel
 ist. Die Regionenmarkierung wird dann in $\mathit{l\_image}$ gespeichert. Das Verfahren wird solange wiederholt, bis
 das Bildsignal $I$ vollständig prozessiert wurde und zusammenhängende Bildregionen in $\mathit{l\_image}$ markiert
 sind. Die Variable $\mathit{pnt}$ enthält die Adresse des zu untersuchenden \gls{pixel} aus $I$. Die nächste freie
 Speicherstelle in $\mathit{l\_image}$ ist in $\mathit{pnt2}$ hinterlegt. In den beiden Schleifen in Zeile
 \ref{alg:arlabeling-regionlabeling-loop1-start}--\ref{alg:arlabeling-regionlabeling-loop1-end} und Zeile
 \ref{alg:arlabeling-regionlabeling-loop2-start}--\ref{alg:arlabeling-regionlabeling-loop2-end} wird das Bildsignal
 zeilenweise, von oben links nach unten rechts, verarbeitet. Das Inkrementieren der Variablen in Zeile
 \ref{alg:arlabeling-regionlabeling-inc1-start}--\ref{alg:arlabeling-regionlabeling-inc1-end} und Zeile
 \ref{alg:arlabeling-regionlabeling-inc2-start}--\ref{alg:arlabeling-regionlabeling-inc2-end} sorgt dafür, dass nur die
 Hälfte der \gls{pixel} prozessiert werden (Vgl. \autoref{sec:vorgehen}). Die Schwellwertanalyse wird in Zeile
 \ref{alg:arlabeling-regionlabeling-threshold-start}--\ref{alg:arlabeling-regionlabeling-threshold-end} durchgeführt.
 Dazu wird in Zeile \ref{alg:arlabeling-regionlabeling-calcblack} die RGB-Komponente des Bildsignals $I$ ausgelesen und
 addiert. Normalerweise würde man an dieser Stelle den Schwellwert mit jeder Komponente $R$, $G$ und $B$ einzeln
 vergleichen. Die Verdreifachung des Schwellwerts in \autoref{alg:arlabeling-init1} und die Addition der
 RGB-Komponenten ermöglichen hingegen eine Schwellwertanalyse mit nur einem Vergleich.\label{sub:arlabel-threshold} In
 Zeile \ref{alg:arlabeling-regionlabeling-isblack?}--\ref{alg:arlabeling-regionlabeling-threshold-end} wird
 untersucht, ob ein Vordergrundpixel gefunden wurde. Falls nicht, wird in das Regionenbild $\mathit{l\_image}$ eine $0$
 geschrieben. Wenn die Schwellertanalyse ein Vordergrundpixel bestimmt hat, müssen in Zeile
 \ref{alg:arlabeling-regionlabeling-black} die Nachbarn des Vordergrundpixels mit einer 8er-Nachbarschaft untersucht
 werden (Vgl. \autoref{alg:arlabeling-neighbour}). Die Laufzeitfunktion für den besten Fall ist in
 \autoref{eq:analyse-arlabeling-regionlabeling-1} angegeben.
\input{eq/artplus/arlabeling-regionlabeling-1}
Durch Substition der Konstanten $c$ mit $1$ folgt
 $T_{best}(\mathit{lxsize},\mathit{lysize}) = 16 \cdot \mathit{lxsize} \cdot \mathit{lysize} - 32 \cdot \mathit{lxsize}
 - 31 \cdot \mathit{lysize} + 61$. Für $c_{1} = 2$, $c_{2} = 16$, $\mathit{lxsize}_0 \geq 9$ und
 $\mathit{lysize}_0 \geq 3$ ist $16 \cdot \mathit{lxsize} \cdot \mathit{lysize} - 32 \cdot \mathit{lxsize}
 - 31 \cdot \mathit{lysize} = \Theta(\mathit{lxsize} \cdot \mathit{lysize})$. Die Laufzeitfunktion für den schlechtesten
 Fall wird nach Analyse der Nachbarschaftsuntersuchung angegeben.

Die Nachbarschafsuntersuchung in ARToolKitPlus untersucht die vier Nachbarn der Markierung an Position $I(u,v)$. Wie in
 \autoref{sec:vorläufige_makierung} bereits beschrieben, ist eine Regionenmarkierung davon abhängig ob alle Nachbarn
 Hintergrundpixel sind, genau ein Nachbar eine Markierung hat oder mehrere Nachbarn eine Markierung haben. Die Fälle
 1, 3 und 4 in \autoref{alg:arlabeling-neighbour} untersuchen, ob genau ein Nachbar eine Markierung hat.
\input{alg/analyse-artplus/arlabeling-neighbour}
Bei Fall 5 sind alle Nachbarn Hintergrundpixel. Nur bei Fall 2 können  mehrere Nachbarn eine Markierung haben. In Zeile
 \ref{alg:arlabeling-neighbour-n3} wird der Variablen $\mathit{pnt1}$ der Nachbar $N_3 = (u,v+1)$ zugewiesen. Die
 Nachbarn sind in \autoref{fig:analyse-nachbarschaftsbeziehung} illustriert.
\begin{figure}[!ht]
	\centering
	\input{resources/8er-Nachbarschaft.pdf_tex}
	\caption{8er-Nachbarschaft mit $N_1 = I(u-1,v)$, $N_2 = I(u-1,v+1)$, $N_3 = (u,v+1)$ und $N_4 = I(u+1,v+1)$.}
	\label{fig:analyse-nachbarschaftsbeziehung}
\end{figure}
\paragraph{1. Fall:} % (fold)
\label{par:fall_1_}
Wir wissen durch \autoref{alg:arlabeling-regionlabeling}, dass $I(u,v)$ ein Vordergrundpixel ist, dem wir an dieser
 Stelle eine Markierung zuweisen wollen. Im ersten Fall wird die Markierung $N_3$ untersucht. Wenn $N_3$ ein
 Vordergrundpixel ist kann die Markierung für $I(u,v)$ übernommen werden. Falls es sich bei den Nachbarn
 $N_1 = I(u-1,v)$, $N_2 = I(u-1,v+1)$ und $N_4 = I(u+1,v+1)$ um Vordergrundpixel handelt, haben sie die gleiche
 Markierung wie $N_3$ und müssen nicht weiter untersucht werden. Das Verfahren ist in
 \autoref{alg:arlabeling-neighbour-case1} beschrieben.
\input{alg/analyse-artplus/arlabeling-neighbour-case1}
In Zeile \ref{alg:arlabeling-neighbour-case1-save-label} wird die Markierung von $N_3$ übernommen und in
 $\mathit{l\_image}$ an Position $(x,y)$ gespeichert. In der Variablen $\mathit{work2}$ werden Informationen der
 Regionenmarkierung gespeichert. Dazu wird zuerst in Zeile \ref{alg:arlabeling-neighbour-case1-calc-offset} aus
 $\mathit{pnt2}$ der Wert der Regionenmarkierung gelesen. Der Wert der Markierung wird zur Berechnung des
 Adressabstands benutzt, um die Werte für die Region an die richtige Stelle zu schreiben. An der Position $0$ von
 $\mathit{work2}$ (Zeile \ref{alg:arlabeling-neighbour-case1-inc-region}) wird die Anzahl der Vordergrundpixel der
 Region erhöht. Position 1 und Position 2 von $\mathit{work2}$ enthalten die akummulierten Werte von $i$ und $j$ für
 die $x$- und $y$-Koordinaten aller Vordergrundpixel der Region. An Position 6 von $\mathit{work2}$ in Zeile
 \ref{alg:arlabeling-neighbour-case1-save-j} wird die $y$-Koordinate gespeichert. Die Kosten des Algorithmus sind in
 \autoref{alg:arlabeling-neighbour-case1} angegeben. Die Laufzeitfunktion $T(n) = 26$ ist konstant.
% paragraph fall_1_ (end)

\paragraph{2. Fall:} % (fold)
\label{par:fall_2_}
Beim zweiten Fall wird die Markierung $N_4$ betrachtet. Da $N_3$ keine Markierung aufweist, können nur $N_1$ und $N_2$
 Markierungen haben. Da die Markierungen nur durch $I(u,v)$ verbunden sind, kann es sich hier um eine Kollision
 handeln, die durch \autoref{alg:arlabeling-neighbour-case2-1} oder \autoref{alg:arlabeling-neighbour-case2-2}
 besonders behandelt wird. Das Verfahren ist in \autoref{alg:arlabeling-neighbour-case2} aufgeführt.
\input{alg/analyse-artplus/arlabeling-neighbour-case2}
In Zeile \ref{alg:arlabeling-neighbour-case2-n2} wird überprüft, ob $N_2$ eine Markierung enthält. Falls ja, wird
 \autoref{alg:arlabeling-neighbour-case2-1} untersuchen, ob eine Kollision vorliegt und sie gegebenfalls auflösen.
 Zeile \ref{alg:arlabeling-neighbour-case2-n1} überprüft $N_1$ auf eine vorhandene Markierung und fährt mit der
 Untersuchung einer evtl. Kollision in \autoref{alg:arlabeling-neighbour-case2-2} fort. Wenn weder $N_2$ noch $N_1$
 eine Markierung haben, ist nur $N_4$ ein Vordergrundpixel und wird mit \autoref{alg:arlabeling-neighbour-case2-3}
 markiert.

In \autoref{alg:arlabeling-neighbour-case2-1} wird in Zeile \ref{alg:arlabeling-neighbour-case2-1-m} der Wert der
 Markierung $N_4$ in Variable $m$ gespeichert.
\input{alg/analyse-artplus/arlabeling-neighbour-case2-1}
In Zeile \ref{alg:arlabeling-neighbour-case2-1-n} wird der Wert $N_2$ in $n$ hinterlegt. In Zeile
 \ref{alg:arlabeling-neighbour-case2-mn-start}--\ref{alg:arlabeling-neighbour-case2-mn-end} wird überprüft, ob $m$
 größer als $n$ ist. Falls dem so ist, wird der Wert $n$ in $\mathit{l\_image}$ gespeichert
 (Zeile \ref{alg:arlabeling-neighbour-case2-saven}). Danach wird in Zeile \ref{alg:arlabeling-neighbour-case2-worklist}
 die Adresse der ersten Stelle der Regionenmarkierungsliste $\mathit{work}$ in $wk$ hinterlegt. In der Schleife von
 Zeile \ref{alg:arlabeling-neighbour-case2-loop-start} bis Zeile \ref{alg:arlabeling-neighbour-case2-loop-end} wird die
 Liste durchlaufen und alle Werte von $m$ durch den Wert $n$ ersetzt. Falls der Wert $m$ kleiner als $n$ ist
 (Zeile \ref{alg:arlabeling-neighbour-case2-nm-start}--\ref{alg:arlabeling-neighbour-case2-nm-stop}) wird das gleiche
 Verfahren angewendet. Lediglich $m$ und $n$ werden getauscht. Wenn es sich bei $m$ und $n$ um den gleichen Wert
 handet, und somit $m$ und $n$ zur gleichen Region gehören, wird der Wert $m$ in $\mathit{l\_image}$ gespeichert
 (Zeile \ref{alg:arlabeling-neighbour-case2-savem}). Die Laufzeitfunktion für den besten Fall ist in
 \autoref{eq:analyse-arlabeling-neighbour-case2-1-1} angegben und ist konstant. Die Laufzeitfunktion für den
 schlechtesten Fall ist in \autoref{eq:analyse-arlabeling-neighbour-case2-1-2} angegeben und durchläuft Zeile
 \ref{alg:arlabeling-neighbour-case2-nm-start}--\ref{alg:arlabeling-neighbour-case2-nm-stop}. Für
 $T_{worst}(\mathit{wk\_max})=5 \mathit{wk\_max} + 14$ und den Werten $c_{1}=5$, $c_{2}=6$ und
 $\mathit{wk\_max}_{0} = 14$ ist $5 \mathit{wk\_max} + 14 = \Theta(n)$.
\input{eq/artplus/arlabeling-neighbour-case2-1}

\autoref{alg:arlabeling-neighbour-case2-2} behandelt den Fall, dass $N_4$ und $N_1$ eine Markierung aufweisen. Das Verfahren entspricht dem Verfahren in \autoref{alg:arlabeling-neighbour-case2-1}.
\input{alg/analyse-artplus/arlabeling-neighbour-case2-2}

In \autoref{alg:arlabeling-neighbour-case2-3} ist der Fall beschrieben, dass $N_4$ der einzige Nachbar des
 Vordergrundpixels $(u,v)$ ist.
\input{alg/analyse-artplus/arlabeling-neighbour-case2-3}
In diesem Fall wird der Wert der Markierung von $N_4$ in $\mathit{l\_image}$ gespeichert
 (Zeile \ref{alg:arlabeling-neighbour-case2-3-n4}). Danach wird der Adressabstand berechnet, um die Informationen der
 Regionenmarkierung in $\mathit{work2}$ zu aktualisieren. Zuerst wird in Zeile
 \ref{alg:arlabeling-neighbour-case2-3-incregion} die Anzahl der Vordergrundpixel der Region erhöht. An Position 1 und
 Position 2 von $\mathit{work2}$ werden die Werte von $i$ und $j$ aufaddiert. Falls in Zeile
 \ref{alg:arlabeling-neighbour-case2-3-isismaller} die Position $x$ des ersten Vordergrundpixels der Region größer ist,
 als der aktuelle Wert in $i$, wird die Position in Zeile \ref{alg:arlabeling-neighbour-case2-3-newi} aktualisiert. Zum
 Schluss wird die Position $y$ des letzten Vordergrundpixels der Region durch den aktuellen Wert $j$ ersetzt. Die
 Laufzeitfunktion ist in \autoref{eq:analyse-arlabeling-neighbour-case2-3} angegeben. Die Wachstumsrate ist konstant.
\input{eq/artplus/arlabeling-neighbour-case2-3}
% paragraph fall_2_ (end)

\paragraph{3. Fall:} % (fold)
\label{par:fall_3_}
Beim dritten Fall wird die Markierung $N_2$ untersucht und wir wissen, dass $N_3$ und $N_4$ keine Markierungen haben
 können. Demnach kann es nur den Nachbarn $N_2$ geben, dessen Markierung an $I(u,v)$ weitergereicht wird. Falls $N_1$
 ebenfalls ein Vordergrundpixel ist, handelt es sich um die gleiche Markierung wie in $N_2$, da beide Vordergrundpixel
 direkt miteinander verbunden sind. Das Verfahren ist in \autoref{alg:arlabeling-neighbour-case3} dargestellt.
\input{alg/analyse-artplus/arlabeling-neighbour-case3}
Für diesen Fall müssen nur die Daten in $\mathit{work2}$ gespeichert werden. Der Wert von $N_2$ wird im Regionenbild
 $\mathit{l\_image}$ gespeichert. Danach wird in Zeile \ref{alg:arlabeling-neighbour-case3-offset} der Adressabstand
 zur Speicherung der Daten in $\mathit{work2}$ berechnet. Danach wird die Anzahl der Vordergrundpixel der Region erhöht
 und $i$ und $j$ auf die bestehenden Werte in $\mathit{work2}$ addiert. Falls die $x$-Koordinate des letzten
 Vordergrundpixels der Region kleiner als der aktuelle Wert $i$ ist, wird die $x$-Koordinate in Zeile
 \ref{alg:arlabeling-neighbour-case3-newi} ersetzt. Zum Schluss wird die $y$-Koordinate des letzten Vordergrundpixels
 der Region mit dem Wert $j$ aktualisiert. Die Laufzeitfunktion ist in \autoref{eq:analyse-arlabeling-neighbour-case3}
 angegeben. Die Wachstumsrate ist konstant.
\input{eq/artplus/arlabeling-neighbour-case3}
% paragraph fall_3_ (end)

\paragraph{4. Fall:} % (fold)
\label{par:fall_4_}
Der vierte Fall untersucht den letzten, und einzigen, Nachbarn $N_1$ (\autoref{alg:arlabeling-neighbour-case4}).
\input{alg/analyse-artplus/arlabeling-neighbour-case4}
Alle anderen Nachbarn sind keine Vordergrundpixel und es besteht keine Kollision. Die Markierung von $N_1$ wird für
 $I(u,v)$ übernommen (Zeile \ref{alg:arlabeling-neighbour-case4-n1}). Ansonsten sind
 \autoref{alg:arlabeling-neighbour-case4} und \autoref{alg:arlabeling-neighbour-case3} identisch. Die Laufzeitfunktion
 in \autoref{eq:analyse-arlabeling-neighbour-case4} hat eine konstante Wachstumsrate.
\input{eq/artplus/arlabeling-neighbour-case4}
% paragraph fall_4_ (end)

\paragraph{5. Fall:} % (fold)
\label{par:fall_5_}
Im letzten Fall sind alle Nachbarn Hintergrundpixel und $\mathit{l\_image}$ wird eine neue Markierung für $I(u,v)$
 zugewiesen (\autoref{alg:arlabeling-neighbour-case5}).
\input{alg/analyse-artplus/arlabeling-neighbour-case5}
In Zeile \ref{alg:arlabeling-neighbour-case5-incwk_max} wird der aktuelle numerische Markierungswert erhöht. Falls der
 Wert in $\mathit{wk\_max}$ größer als ein festgelegter Wert ist, wird das Verfahren abgebrochen, da zuviele Regionen
 im Bildsignal $I$ vorkommen. Die Markierung wird in Zeile \ref{alg:arlabeling-neighbour-case5-save-uv} in
 $\mathit{l\_image}$ gespeichert. Danach wird der Wert der Markierung in die Liste der Markierungen $\mathit{work}$
 eingetragen. Der Adressabstand für die Region mit der Markierung $\mathit{wk\_max}$ wird in Zeile
 \ref{alg:arlabeling-neighbour-case5-offset} berechnet. Anschließend wird die neue Region in $\mathit{work2}$
 gespeichert. Der erste Vordergrundpixel wird in Zeile \ref{alg:arlabeling-neighbour-case5-offset-0} an Position $0$
 von $\mathit{work2}$ gespeichert. Danach werden in Zeile
 \ref{alg:arlabeling-neighbour-case5-offset-1}--\ref{alg:arlabeling-neighbour-case5-offset-1} die Position des ersten
 Vordergrundpixels gespeichert. Die Laufzeitfunktion ist in \autoref{eq:analyse-arlabeling-neighbour-case5} angegeben.
 Die Wachstumsrate der Funktion ist konstant.
\input{eq/artplus/arlabeling-neighbour-case5}
% paragraph fall_5_ (end)

Nachdem die Regionemarkierung abgeschlossen ist, enthält $\mathit{work}$ die numerischen Werte der Regionen. In
 $\mathit{work2}$ ist für jede Region die Anzahl der Vordergrundpixel, die summierten $x$- und $y$-Koordinaten aller
 Vordergrundpixel, sowie die $x$- und $y$-Koordinate für den ersten und letzten Vordergrundpixel, hinterlegt. Das
 Regionenbild ist in $\mathit{l\_image}$ gespeichert. Der schlechteste Fall der Nachbarschaftsuntersuchung ist der 2.
 Fall. Die Laufzeitfunktion (\autoref{eq:analyse-arlabeling-neighbour}) setzt sich aus den Kosten der Verzweigung in
 \autoref{alg:arlabeling-neighbour} und \autoref{alg:arlabeling-neighbour-case2}, sowie der Laufzeifunktion aus
 \autoref{alg:arlabeling-neighbour-case2-1}, zusammen. Für $c_{1} = 5$, $c_{2} = 6$ und $\mathit{wk\_max}_0 \geq 24$ ist
 $5 \mathit(wk\_max) + 24 = \Theta(\mathit{wk\_max})$.
\input{eq/artplus/arlabeling-neighbour}

Nachdem die Laufzeitfunktion der einzelnen Fälle der Regionenmarkierung bekannt sind, kann die Laufzeitfunktion von
 \textproc{arLabeling} (\autoref{alg:arlabeling-regionlabeling}) für den schlechtesten Fall untersucht werden. Die
 Laufzeitfunktion ist in \autoref{eq:analyse-arlabeling-regionlabeling-2} angegeben.
\input{eq/artplus/arlabeling-regionlabeling-2}
Durch Substitution der Konstanten $c$ mit $1$ folgt $T_{worst}(\mathit{lxsize},\mathit{lysize}) = 15 \mathit{lxsize}
 \cdot \mathit{lysize} + \mathit{lxsize} \cdot \mathit{lysize} \cdot t - 30 \mathit{lxsize} - 2 \mathit{lxsize} \cdot t
 -30 \mathit{lysize} - 2 \mathit{lysize} \cdot t + 61 + 4t$. Die Variable $t$ steht für die Laufzeitfunktion in
 \autoref{eq:analyse-arlabeling-neighbour}. Die Eingabemenge $\mathit{wk\_max}$ ist von $\mathit{lxsize}$ und
 $\mathit{lysize}$ abhänging und kann nicht mehr als $8192$ Einträge enthalten. Wird $t$ durch $5 \cdot 8192 + 24$
 substituiert, folgt die Laufzeitfunktion in \autoref{eq:analyse-arlabeling-regionlabeling-3}.
\input{eq/artplus/arlabeling-regionlabeling-3}
Für $c_{1} = 2$, $c_{2} = 40999$, $\mathit{lxsize}_0 \geq 5$ und $\mathit{lysize}_0 \geq 4$ ist die Wachstumsrate von
 $40999\mathit{lxsize}\cdot\mathit{lysize} -81998\mathit{lxsize} -81998\mathit{lysize}
 = \Theta(\mathit{lxsize}\cdot\mathit{lysize})$.

Die erfassten Daten müssen nach der Regionenmarkierung in Schritt \ref{label-cleaning} von
 \autoref{alg:arlabeling-overview} aufbereitet werden. Zuerst werden mit \autoref{alg:sortlabels} die Werte in
 $\mathit{work}$ sortiert.
\input{alg/analyse-artplus/arlabeling-sortlabels}
Die aufsteigenden Markierungswerte in $\mathit{work}$ sind duch Kollisionen in
 \autoref{alg:arlabeling-neighbour-case2-1} durch kleinere Werte ersetzt worden. Dadurch ist eine Lücke im Interval
 $\left[1,2,3..n\right]$ der numerischen Werte entstanden. Diese Lücken werden durch \autoref{alg:sortlabels}
 entfernt, um wieder ein aufsteigendes Interval zu erhalten.

In Zeile \ref{alg:sortlabels-j} wird $j$ als Variable für die aktuelle Markierung initialisiert. In Zeile
 \ref{alg:sortlabels-address} wird die Adresse der ersten Markierung aus $\mathit{work}$ in $\mathit{wk}$ gespeichert.
 Die Schleife in Zeile \ref{alg:sortlabels-loop-start}--\ref{alg:sortlabels-loop-end} überprüft, ob die numerischen
 Werte ohne Lücken durch Kollisionen gespeichert sind. Dazu wird jeder Eintrag in $\mathit{work}$ mit der Laufvariable
 $i$ verglichen. Falls keine Kollisionen vorliegen, werden die Werte in $\mathit{work}$ immer mit $i$ übereinstimmen,
 da keine Lücken im Intervall vorhanden sind. In Zeile \ref{alg:sortlabels-savelabel} wird dann der Wert aus $j$ an die
 aktuelle Position von $\mathit{work}$ geschrieben und $j$ danach inkrementiert. Bei einer Kollision stimmt der Wert in
 $\mathit{work}$ nicht mit $i$ überein
 (Zeile \ref{alg:sortlabels-collision-start}--\ref{alg:sortlabels-collision-end}). In diesem Fall wird der Wert an der
 aktuellen Position von $\mathit{work}$ ausgelesen und dekrementiert. Dieser Wert wird als Index verwendet um den Wert
 des zuletzt zugewiesenen Markierungswert an die aktuelle Position von $\mathit{work}$ zu schreiben. Da die Variable
 $j$ in diesem Fall nicht inkrementiert wird, enthält sie den nächsten Wert des Markierungsintervals. In Zeile
 \ref{alg:sortlabels-inci} wird die Laufvariable $i$ um $1$ erhöht und in Zeile \ref{alg:sortlabels-incwk} die Adresse
 von $\mathit{work}$ inkrementiert. Das Beispiel in \autoref{fig:} illustriert das Verfahren. In
 \autoref{eq:analyse-arlabeling-sortlabels} ist die Laufzeitfunktion angegeben. Für $c_{1} = 4$, $c_{2} = 7$ und
 $\mathit{wk\_max}_0 \geq 1$ ist die Wachstumsrate $7\mathit{wk\_max} - 3 = \Theta(\mathit{wk\_max})$.
\input{eq/artplus/arlabeling-sortlabels}

Das Verfahren in \autoref{alg:arlabeling-initlabelmemory} initialisiert den Speicher zur Berechnung des Flächeninhalts
 einer Region und den Speicher der Koordinaten des Mittelpunkts einer Region.
\input{alg/analyse-artplus/arlabeling-initlabelmemory}
Dazu wird in Zeile
 \ref{alg:arlabeling-initlabelmemory-label-start}--\ref{alg:arlabeling-initlabelmemory-label-end} der größte
 Markierungswert aus $\mathit{work}$ in $\mathit{wlabel\_num}$ und $\mathit{label\_num}$ gespeichert. Falls in der
 Überprüfung in Zeile
 \ref{alg:arlabeling-initlabelmemory-islabel-start}--\ref{alg:arlabeling-initlabelmemory-islabel-end}
 $\mathit{label\_num}$ keine Markierung enthält, wird das Verfahren abgebrochen und das Regionenbild $\mathit{l\_image}$
 zurückgegeben. Andernfalls wird in Zeile
 \ref{alg:arlabeling-initlabelmemory-initwarea-start}--\ref{alg:arlabeling-initlabelmemory-initwarea-end} der Speicher
 des Flächeinhalts $\mathit{warea}$ mit dem Wert $0$ initialisiert, indem über die Größe des Speichers iteriert wird.
 Der Speicher zur Berechnung des Mittelpunkts der Regionen wird in Zeile
 \ref{alg:arlabeling-initlabelmemory-initwpos-start}--\ref{alg:arlabeling-initlabelmemory-initwpos-end} nach dem
 gleichen Prinzip initialisiert. Die Laufzeitfunktion für Zeile
 \ref{alg:arlabeling-initlabelmemory-label-start}--\ref{alg:arlabeling-initlabelmemory-initwarea-end} von
 \autoref{alg:arlabeling-initlabelmemory} ist in \autoref{eq:analyse-arlabeling-sortlabels-initlabelmemory-1} angegeben.
\input{eq/artplus/arlabeling-sortlabels-initlabelmemory-1}
Für $c_{1} = 4$, $c_{2} = 12$ und $\mathit{size}_0 \geq 1$ ist die Wachstumsrate
 $4\mathit{size} + 8 = \Theta(\mathit{size})$. Die Laufzeitfunktion für Zeile
 \ref{alg:arlabeling-initlabelmemory-floatsize}--\ref{alg:arlabeling-initlabelmemory-initwpos-end} ist in
 \autoref{eq:analyse-arlabeling-sortlabels-initlabelmemory-2} aufgeführt.
\input{eq/artplus/arlabeling-sortlabels-initlabelmemory-2}
Die Wachstumsrate ist $4\mathit{size} + 4 = \Theta(\mathit{size})$ für $c_{1} = 4$, $c_{2} = 8$ und
 $\mathit{size}_0 \geq 1$.

In \autoref{alg:arlabeling-calcregiondata} werden die Daten aller Regionenmarkierungen aufbereitet. Das Verfahren
 berechnet den Flächeninhalt, den Mittelpunkt und die Start- und Endkoordinaten für alle Regionen.
\input{alg/analyse-artplus/arlabeling-calcregiondata}
Dazu wird in Zeile \ref{alg:arlabeling-calcregiondata-wclip-start}--\ref{alg:arlabeling-calcregiondata-wclip-end} der
 Speicher der Start- und Endkoordinaten initialisiert, indem über die Menge der Regionen itertiert wird und die
 Initialwerte, $\mathit{lxsize}$ und $0$ für die Startkoordiante und $\mathit{lysize}$ und $0$ für die Endkoordinate,
 gespeichert werden. In Zeile
 \ref{alg:arlabeling-calcregiondata-work-start}--\ref{alg:arlabeling-calcregiondata-work-end} werden die Werte aus
 $\mathit{work2}$ aufbereitet, indem über die Anzahl der Regionen iteriert wird. In Zeile
 \ref{alg:arlabeling-calcregiondata-label} wird die Regionemarkierung ausgelesen und in $j$ gespeichert. Danach wird
 die Anzahl der Vordergrundpixel für Region $j$ aus $\mathit{work2}$ ausgelesen und in $\mathit{warea}$ gespeichert. In
 Zeile \ref{alg:arlabeling-calcregiondata-sumx}--\ref{alg:arlabeling-calcregiondata-sumy} werden die summierten $x$- und
 $y$-Koordinaten aus $\mathit{work2}$ ausgelsen und in $\mathit{wpos}$ gespeichert. Die Überprüfung des $x$-Werts in
 Zeile \ref{alg:arlabeling-calcregiondata-startx-start}--\ref{alg:arlabeling-calcregiondata-startx-end} sorgt dafür,
 dass die Startkoordinate soweit links wie möglich beginnt. Der $x$-Wert der Endkoordinate wird in Zeile
 \ref{alg:arlabeling-calcregiondata-endx-start}--\ref{alg:arlabeling-calcregiondata-endx-end} überprüft. Bei dieser
 Überprüfung soll der $x$-Wert der Endkoordinate soweit rechts wie möglich liegen. Zeile
 \ref{alg:arlabeling-calcregiondata-y-start}--\ref{alg:arlabeling-calcregiondata-y-end} wiederholen das Verfahren für
 den $y$-Wert der Start- und Endkoordinate. Danach wird in Zeile
 \ref{alg:arlabeling-calcregiondata-pos-start}--\ref{alg:arlabeling-calcregiondata-pos-end} die Position des
 Mittelpunkts einer Region berechnet, indem die aufsummierten Koordinaten einer Region durch die Anzahl der
  Vordergrundpixel in $\mathit{warea}$ geteilt wird. Zuletzt werden die lokalen Variablen in den Übergabeparametern
 gespeichert und das Regionenbild $\mathit{l\_image}$ an die aufrufende Methode zurückgegeben. An dieser Stelle ist
 \textproc{arLabeling} (\autoref{alg:arlabeling-overview}) abgeschlossen.

Die Laufzeitfunktion für Zeile
 \ref{alg:arlabeling-calcregiondata-wclip-start}--\ref{alg:arlabeling-calcregiondata-wclip-end} von
 \autoref{alg:arlabeling-calcregiondata} ist in \autoref{eq:analyse-arlabeling-calcregiondata-1} angegeben.
\input{eq/artplus/arlabeling-calcregiondata-1}
Die Wachstumsrate, für die Werte $c_{1} = 18$, $c_{2} = 19$ und $\mathit{labelnum}_0 \geq 1$, ist
 $18\mathit{labelnum} + 1 = \Theta(\mathit{labelnum})$. Die Laufzeitfunktion von Zeile
 \ref{alg:arlabeling-calcregiondata-work-start}--\ref{alg:arlabeling-calcregiondata-work-end} ist in
 \autoref{eq:analyse-arlabeling-calcregiondata-2} aufgeführt. Für $c_{1} = 90$, $c_{2} = 91$ und
 $\mathit{wk\_max}_0 \geq 1$ ist die Wachstumsrate $90\mathit{wk\_max} + 1 = \Theta(wk\_max)$.
\input{eq/artplus/arlabeling-calcregiondata-2}
Die letzte Laufzeitfunktion von \autoref{alg:arlabeling-calcregiondata} ist in
 \autoref{eq:analyse-arlabeling-calcregiondata-2} angegeben.
\input{eq/artplus/arlabeling-calcregiondata-3}
Die Wachstumsrate entspricht $20\mathit{labelnum} + 6 = \Theta(\mathit{labelnum})$, für $c_{1} = 20$, $c_{2} = 21$ und
 $\mathit{labelnum}_0 \geq 6$.

Die Laufzeitfunktion von \textproc{arLabeling} (\autoref{alg:arlabeling-overview}) ist in
 \autoref{eq:analyse-arlabeling-all-1} angegeben und besteht aus der Initialisierung (\autoref{alg:arlabeling-init1}
 und \autoref{alg:arlabeling-init2}), der Regionenmarkierung
 (\autoref{alg:arlabeling-regionlabeling}--\autoref{alg:arlabeling-neighbour-case5}) und der Aufbereitung und
 Speicherung der Daten (\autoref{alg:sortlabels}--\autoref{alg:arlabeling-calcregiondata}).
\input{eq/artplus/arlabeling-all-1}
Die Eingabemenge des Algorithmus ist das Bildsignal $I$, dass aus $\mathit{lxsize} \cdot \mathit{lysize}$ besteht. Die
 Variable $\mathit{wk\_max}$ ist auf $8192$ Einträge begrenzt. Die Menge $\mathit{size}$ bei
 \autoref{alg:arlabeling-initlabelmemory} ist abhängig von $\mathit{labelnum}$, die bei einer Bildgröße von
 $\mathit{lxsize} \cdot \mathit{lysize}$ maximal $\bigl\lceil\frac{\mathit{lxsize}}{2}\bigr\rceil
 \cdot \bigl\lceil\frac{\mathit{lysize}}{2}\bigr\rceil$ Regionenmarkierungen anlgegen kann.
 $\mathit{int}$ und $\mathit{float}$ sind jeweils $4$ Byte groß, sodaß
 $\mathit{size} = \bigl\lceil\frac{\mathit{lxsize}}{2}\bigr\rceil \cdot \bigl\lceil\frac{\mathit{lysize}}{2}\bigr\rceil
 \cdot 4$ und $\mathit{size}' = \bigl\lceil\frac{\mathit{lxsize}}{2}\bigr\rceil
 \cdot \bigl\lceil\frac{\mathit{lysize}}{2}\bigr\rceil \cdot 2 \cdot 4$.
Dadurch wird \autoref{eq:analyse-arlabeling-all-1} zu \autoref{eq:analyse-arlabeling-all-2} überführt.
\input{eq/artplus/arlabeling-all-2}
Das Wachstum der Laufzeitfunktion ist
\begin{equation*}
\frac{1}{2}82041\mathit{lxsize} \cdot \mathit{lysize} -81992\mathit{lxsize} -81990\mathit{lysize}
 = \Theta(\mathit{lxsize}\cdot\mathit{lysize})
\end{equation*}
für
\begin{equation*}
c_{1} = \frac{82041\mathit{lxsize}\cdot\mathit{lysize} -163984\mathit{lxsize}
 -163980\mathit{lysize}}{\mathit{lxsize}\cdot\mathit{lysize}} \text{,}
\end{equation*}
\begin{equation*}
c_{2} = \frac{82041\mathit{lxsize}\cdot\mathit{lysize} -163984\mathit{lxsize}
 -163980\mathit{lysize}}{2\mathit{lxsize}\cdot\mathit{lysize}} \text{,}
\end{equation*}
$\mathit{lxsize}_0 \geq 1$ und $\mathit{lysize}_0 \geq 1$.
% subsubsection regionenmarkierung (end)
